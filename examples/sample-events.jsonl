{"id":"evt-001","timestamp":"2025-01-15T10:30:00.000Z","type":"session_created","session_id":"sess-abc123","fields":{"workspace":"/home/user/project","policy":"default"}}
{"id":"evt-002","timestamp":"2025-01-15T10:30:01.123Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-001","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[0]","message":"allowed by default"},"fields":{"command":"ls","args":["-la"]}}
{"id":"evt-003","timestamp":"2025-01-15T10:30:01.124Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-001","fields":{"command":"ls","args":["-la"]}}
{"id":"evt-004","timestamp":"2025-01-15T10:30:01.250Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-001","fields":{"exit_code":0,"duration_ms":126,"cpu_user_ms":5,"cpu_system_ms":3,"memory_peak_kb":1024}}
{"id":"evt-005","timestamp":"2025-01-15T10:30:05.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-002","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[1]","message":"git commands allowed"},"fields":{"command":"git","args":["status"]}}
{"id":"evt-006","timestamp":"2025-01-15T10:30:05.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-002","fields":{"command":"git","args":["status"]}}
{"id":"evt-007","timestamp":"2025-01-15T10:30:05.150Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-002","fields":{"exit_code":0,"duration_ms":149,"cpu_user_ms":12,"cpu_system_ms":8,"memory_peak_kb":2048}}
{"id":"evt-008","timestamp":"2025-01-15T10:30:10.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-003","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[2]","message":"cat allowed for reading"},"fields":{"command":"cat","args":["src/main.go"]}}
{"id":"evt-009","timestamp":"2025-01-15T10:30:10.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-003","fields":{"command":"cat","args":["src/main.go"]}}
{"id":"evt-010","timestamp":"2025-01-15T10:30:10.002Z","type":"file_read","session_id":"sess-abc123","command_id":"cmd-003","pid":12345,"path":"/home/user/project/src/main.go","policy":{"decision":"allow","effective_decision":"allow","rule":"files.read[0]","message":"workspace files allowed"},"fields":{}}
{"id":"evt-011","timestamp":"2025-01-15T10:30:10.050Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-003","fields":{"exit_code":0,"duration_ms":49,"cpu_user_ms":2,"cpu_system_ms":1,"memory_peak_kb":512}}
{"id":"evt-012","timestamp":"2025-01-15T10:30:15.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-004","operation":"command_precheck","policy":{"decision":"deny","effective_decision":"deny","rule":"commands.deny[0]","message":"rm -rf blocked for safety"},"fields":{"command":"rm","args":["-rf","/"]}}
{"id":"evt-013","timestamp":"2025-01-15T10:30:20.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-005","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[3]","message":"curl allowed"},"fields":{"command":"curl","args":["https://api.github.com/repos/agentsh/agentsh"]}}
{"id":"evt-014","timestamp":"2025-01-15T10:30:20.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-005","fields":{"command":"curl","args":["https://api.github.com/repos/agentsh/agentsh"]}}
{"id":"evt-015","timestamp":"2025-01-15T10:30:20.010Z","type":"net_connect","session_id":"sess-abc123","command_id":"cmd-005","domain":"api.github.com","remote":"api.github.com:443","policy":{"decision":"allow","effective_decision":"allow","rule":"network.allow[0]","message":"github.com allowed"},"fields":{"port":443}}
{"id":"evt-016","timestamp":"2025-01-15T10:30:20.500Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-005","fields":{"exit_code":0,"duration_ms":499,"cpu_user_ms":25,"cpu_system_ms":15,"memory_peak_kb":4096}}
{"id":"evt-017","timestamp":"2025-01-15T10:30:25.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-006","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[3]","message":"curl allowed"},"fields":{"command":"curl","args":["http://internal.corp.local/secrets"]}}
{"id":"evt-018","timestamp":"2025-01-15T10:30:25.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-006","fields":{"command":"curl","args":["http://internal.corp.local/secrets"]}}
{"id":"evt-019","timestamp":"2025-01-15T10:30:25.010Z","type":"net_connect","session_id":"sess-abc123","command_id":"cmd-006","domain":"internal.corp.local","remote":"internal.corp.local:80","policy":{"decision":"deny","effective_decision":"deny","rule":"network.deny[0]","message":"internal networks blocked"},"fields":{"port":80}}
{"id":"evt-020","timestamp":"2025-01-15T10:30:25.011Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-006","fields":{"exit_code":7,"duration_ms":10,"cpu_user_ms":1,"cpu_system_ms":1,"memory_peak_kb":512,"error":"network connection denied by policy"}}
{"id":"evt-021","timestamp":"2025-01-15T10:30:30.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-007","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[4]","message":"go commands allowed"},"fields":{"command":"go","args":["build","./..."]}}
{"id":"evt-022","timestamp":"2025-01-15T10:30:30.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-007","fields":{"command":"go","args":["build","./..."]}}
{"id":"evt-023","timestamp":"2025-01-15T10:30:30.100Z","type":"file_read","session_id":"sess-abc123","command_id":"cmd-007","pid":12350,"path":"/home/user/project/go.mod","policy":{"decision":"allow","effective_decision":"allow","rule":"files.read[0]","message":"workspace files allowed"},"fields":{}}
{"id":"evt-024","timestamp":"2025-01-15T10:30:30.150Z","type":"file_read","session_id":"sess-abc123","command_id":"cmd-007","pid":12350,"path":"/home/user/project/go.sum","policy":{"decision":"allow","effective_decision":"allow","rule":"files.read[0]","message":"workspace files allowed"},"fields":{}}
{"id":"evt-025","timestamp":"2025-01-15T10:30:32.000Z","type":"file_write","session_id":"sess-abc123","command_id":"cmd-007","pid":12350,"path":"/home/user/project/bin/app","policy":{"decision":"allow","effective_decision":"allow","rule":"files.write[0]","message":"workspace writes allowed"},"fields":{}}
{"id":"evt-026","timestamp":"2025-01-15T10:30:35.000Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-007","fields":{"exit_code":0,"duration_ms":4999,"cpu_user_ms":3500,"cpu_system_ms":800,"memory_peak_kb":524288}}
{"id":"evt-027","timestamp":"2025-01-15T10:30:40.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-008","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[2]","message":"cat allowed"},"fields":{"command":"cat","args":["/etc/shadow"]}}
{"id":"evt-028","timestamp":"2025-01-15T10:30:40.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-008","fields":{"command":"cat","args":["/etc/shadow"]}}
{"id":"evt-029","timestamp":"2025-01-15T10:30:40.002Z","type":"file_read","session_id":"sess-abc123","command_id":"cmd-008","pid":12355,"path":"/etc/shadow","policy":{"decision":"deny","effective_decision":"deny","rule":"files.deny[0]","message":"sensitive system files blocked"},"fields":{}}
{"id":"evt-030","timestamp":"2025-01-15T10:30:40.003Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-008","fields":{"exit_code":1,"duration_ms":2,"cpu_user_ms":0,"cpu_system_ms":1,"memory_peak_kb":256,"error":"file read denied by policy"}}
{"id":"evt-031","timestamp":"2025-01-15T10:30:45.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-009","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[5]","message":"tee allowed for writing"},"fields":{"command":"tee","args":["/home/user/project/output.txt"]}}
{"id":"evt-032","timestamp":"2025-01-15T10:30:45.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-009","fields":{"command":"tee","args":["/home/user/project/output.txt"]}}
{"id":"evt-033","timestamp":"2025-01-15T10:30:45.050Z","type":"file_write","session_id":"sess-abc123","command_id":"cmd-009","pid":12360,"path":"/home/user/project/output.txt","policy":{"decision":"allow","effective_decision":"allow","rule":"files.write[0]","message":"workspace writes allowed"},"fields":{}}
{"id":"evt-034","timestamp":"2025-01-15T10:30:45.100Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-009","fields":{"exit_code":0,"duration_ms":99,"cpu_user_ms":3,"cpu_system_ms":2,"memory_peak_kb":512}}
{"id":"evt-035","timestamp":"2025-01-15T10:30:50.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-010","operation":"command_precheck","policy":{"decision":"allow","effective_decision":"allow","rule":"commands.allow[5]","message":"tee allowed"},"fields":{"command":"tee","args":["/etc/hosts"]}}
{"id":"evt-036","timestamp":"2025-01-15T10:30:50.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-010","fields":{"command":"tee","args":["/etc/hosts"]}}
{"id":"evt-037","timestamp":"2025-01-15T10:30:50.002Z","type":"file_write","session_id":"sess-abc123","command_id":"cmd-010","pid":12365,"path":"/etc/hosts","policy":{"decision":"deny","effective_decision":"deny","rule":"files.deny[1]","message":"system files write blocked"},"fields":{}}
{"id":"evt-038","timestamp":"2025-01-15T10:30:50.003Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-010","fields":{"exit_code":1,"duration_ms":2,"cpu_user_ms":0,"cpu_system_ms":1,"memory_peak_kb":256,"error":"file write denied by policy"}}
{"id":"evt-039","timestamp":"2025-01-15T10:30:55.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-011","operation":"command_precheck","policy":{"decision":"deny","effective_decision":"deny","rule":"commands.deny[1]","message":"sudo blocked"},"fields":{"command":"sudo","args":["apt","install","malware"]}}
{"id":"evt-040","timestamp":"2025-01-15T10:31:00.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-012","operation":"command_precheck","policy":{"decision":"approve","effective_decision":"allow","rule":"commands.approve[0]","message":"npm install requires approval","approval":{"required":true,"mode":"interactive","id":"apr-001"}},"fields":{"command":"npm","args":["install"]}}
{"id":"evt-041","timestamp":"2025-01-15T10:31:02.001Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-012","fields":{"command":"npm","args":["install"]}}
{"id":"evt-042","timestamp":"2025-01-15T10:31:02.500Z","type":"net_connect","session_id":"sess-abc123","command_id":"cmd-012","domain":"registry.npmjs.org","remote":"registry.npmjs.org:443","policy":{"decision":"allow","effective_decision":"allow","rule":"network.allow[1]","message":"npm registry allowed"},"fields":{"port":443}}
{"id":"evt-043","timestamp":"2025-01-15T10:31:10.000Z","type":"file_write","session_id":"sess-abc123","command_id":"cmd-012","pid":12370,"path":"/home/user/project/node_modules/.package-lock.json","policy":{"decision":"allow","effective_decision":"allow","rule":"files.write[0]","message":"workspace writes allowed"},"fields":{}}
{"id":"evt-044","timestamp":"2025-01-15T10:31:15.000Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-012","fields":{"exit_code":0,"duration_ms":12999,"cpu_user_ms":8000,"cpu_system_ms":2000,"memory_peak_kb":262144}}
{"id":"evt-045","timestamp":"2025-01-15T10:31:20.000Z","type":"command_policy","session_id":"sess-abc123","command_id":"cmd-013","operation":"command_precheck","policy":{"decision":"redirect","effective_decision":"allow","rule":"commands.redirect[0]","message":"python3 redirected from python","redirect":{"from_command":"python","to_command":"python3"}},"fields":{"command":"python","args":["script.py"]}}
{"id":"evt-046","timestamp":"2025-01-15T10:31:20.001Z","type":"command_redirected","session_id":"sess-abc123","command_id":"cmd-013","policy":{"decision":"redirect","effective_decision":"allow","rule":"commands.redirect[0]","redirect":{"from_command":"python","to_command":"python3"}},"fields":{"from_command":"python","from_args":["script.py"],"to_command":"python3","to_args":["script.py"]}}
{"id":"evt-047","timestamp":"2025-01-15T10:31:20.002Z","type":"command_started","session_id":"sess-abc123","command_id":"cmd-013","fields":{"command":"python3","args":["script.py"]}}
{"id":"evt-048","timestamp":"2025-01-15T10:31:22.000Z","type":"command_finished","session_id":"sess-abc123","command_id":"cmd-013","fields":{"exit_code":0,"duration_ms":1998,"cpu_user_ms":1500,"cpu_system_ms":200,"memory_peak_kb":32768}}
{"id":"evt-049","timestamp":"2025-01-15T10:31:25.000Z","type":"dns_query","session_id":"sess-abc123","command_id":"cmd-013","domain":"pypi.org","policy":{"decision":"allow","effective_decision":"allow","rule":"network.allow[2]","message":"pypi allowed"},"fields":{"ips":["151.101.0.223","151.101.64.223"],"source":"proxy"}}
{"id":"evt-050","timestamp":"2025-01-15T10:31:30.000Z","type":"file_soft_deleted","session_id":"sess-abc123","command_id":"cmd-014","pid":12380,"path":"/home/user/project/temp.txt","policy":{"decision":"allow","effective_decision":"allow","rule":"files.write[0]"},"fields":{"trash_token":"tok-abc123","restore_hint":"agentsh trash restore tok-abc123"}}
