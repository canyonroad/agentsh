# Generated by: agentsh policy generate sess-abc123
# Source session: sess-abc123
# Generated at: 2025-01-15T10:31:00Z
# Session duration: 25s
# Total events analyzed: 26

version: 1
name: ci-build
description: Auto-generated from session sess-abc123

file_rules:
  # Provenance: 3 events (10:30:00 - 10:30:10)
  - name: workspace-src
    description: Source files
    paths: ["/home/user/project/src/**"]
    operations: ["read"]
    decision: allow

command_rules:
  # Provenance: 3 events (10:30:01 - 10:30:05)
  - name: safe-commands
    description: Standard dev commands
    commands: ["ls", "git", "cat"]
    decision: allow
  # RISKY: network command
  # Provenance: 2 events (10:30:20 - 10:30:25)
  - name: curl-downloads
    description: Network downloads
    commands: ["curl"]
    args_pattern: "^https://.*$"
    decision: allow
  # --- Blocked operations (uncomment to allow) ---
  # BLOCKED: rm -rf blocked for safety
  # Provenance: 1 events (10:30:15)
  # - name: rm-commands
  #   commands: ["rm"]
  #   decision: allow

network_rules:
  # Provenance: 1 events (10:30:20)
  - name: github-api
    description: GitHub API access
    domains: ["api.github.com"]
    ports: [443]
    decision: allow
  # --- Blocked operations (uncomment to allow) ---
  # BLOCKED: internal networks blocked
  # Provenance: 1 events (10:30:25)
  # - name: internal-corp
  #   domains: ["internal.corp.local"]
  #   ports: [80]
  #   decision: allow

mcp_rules:
  enforce_policy: true
  tool_policy: "allowlist"
  allowed_tools:
    # Provenance: 2 events (10:30:17 - 10:30:18)
    - server: "notes"
      tool: "read_note"
      content_hash: "sha256:a1b2c3"
    # Provenance: 1 events (10:30:17)
    - server: "notes"
      tool: "write_note"
      content_hash: "sha256:d4e5f6"
    # Provenance: 2 events (10:30:17 - 10:30:18)
    - server: "web-search"
      tool: "search"
      content_hash: "sha256:111222"
    # Provenance: 1 events (10:30:17)
    - server: "web-search"
      tool: "summarize"
      content_hash: "sha256:555666"
  server_policy: "allowlist"
  allowed_servers:
    - id: "notes"
    - id: "web-search"
  # --- Blocked tools (uncomment to allow) ---
  # denied_tools:
  #   # BLOCKED: version_pin (tool definition changed)
  #   # Provenance: 1 events (10:30:19)
  #   - server: "web-search"
  #     tool: "fetch_url"
  version_pinning:
    enabled: true
    on_change: "block"
    auto_trust_first: true
  cross_server:
    enabled: true
    read_then_send:
      enabled: true
